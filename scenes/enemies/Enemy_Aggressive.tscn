[gd_scene load_steps=16 format=3 uid="uid://c3oro1bq5e7is"]

[ext_resource type="PackedScene" path="res://scenes/shared/StatsComponent.tscn" id="1"]
[ext_resource type="Script" uid="uid://dptpyua3c2j1a" path="res://scenes/enemies/enemy_health_label.gd" id="2"]
[ext_resource type="Script" uid="uid://cnrcn6yeejvjq" path="res://scenes/shared/DeathHandlerComponent.gd" id="3_lk9dp"]
[ext_resource type="Script" uid="uid://cux4ue1l25rak" path="res://scenes/enemies/enemy_controller.gd" id="4_cye0q"]
[ext_resource type="Script" uid="uid://bec0agfuxgv37" path="res://scenes/enemies/ai/behavior_state_machine.gd" id="5_yhoux"]
[ext_resource type="Script" uid="uid://xy6x24s6f7sg" path="res://scenes/enemies/ai/combat_state_machine.gd" id="6_30fmc"]
[ext_resource type="Script" uid="uid://jl20nfdx6mox" path="res://scenes/enemies/ai/states/behavior_idle_state.gd" id="7_hzxm6"]
[ext_resource type="Script" uid="uid://x0g2hu3xpju3" path="res://scenes/enemies/ai/states/combat_attack_state.gd" id="8_hau8f"]
[ext_resource type="Script" uid="uid://6in3o1smlv5" path="res://scenes/enemies/ai/states/combat_chase_state.gd" id="9_xopsu"]
[ext_resource type="Script" uid="uid://qcf7c6gt57fd" path="res://scenes/enemies/ai/states/combat_flee_state.gd" id="10_fwdrj"]
[ext_resource type="Resource" path="res://scenes/shared/attacks/EnemyBashAttack.tres" id="11_bash"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_red"]
radius = 0.50683594

[sub_resource type="CapsuleMesh" id="CapsuleMesh_red"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_12rgf"]
albedo_color = Color(0.37753016, 0.5956128, 0.4160812, 1)

[sub_resource type="SphereShape3D" id="SphereShape3D_attack"]
radius = 2.6456902

[node name="AgressiveEnemy" type="CharacterBody3D"]
script = ExtResource("4_cye0q")
is_aggressive_on_sight = true
attack_profile = ExtResource("11_bash")
attack_area_path = NodePath("EnemyCharacter#AttackRangeArea")
attack_ray_path = NodePath("EnemyCharacter#SwipeRay")

[node name="EnemyCharacter#NavigationAgent" type="NavigationAgent3D" parent="."]
path_max_distance = 32.0
height = 1.8
radius = 0.38

[node name="EnemyCharacter#CapsuleCollision" type="CollisionShape3D" parent="."]
shape = SubResource("CapsuleShape3D_red")
debug_color = Color(0, 0.4813334, 0.76, 1)

[node name="EnemyCharacter#CapsuleVisual" type="MeshInstance3D" parent="."]
mesh = SubResource("CapsuleMesh_red")
surface_material_override/0 = SubResource("StandardMaterial3D_12rgf")

[node name="EnemyCharacter#AttackRangeArea" type="Area3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)

[node name="EnemyCharacter#AttackRangeCollision" type="CollisionShape3D" parent="EnemyCharacter#AttackRangeArea"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -1, 0)
shape = SubResource("SphereShape3D_attack")

[node name="EnemyCharacter#SwipeRay" type="RayCast3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
target_position = Vector3(0, 0, -2)

[node name="EnemyCharacter#StatsComponent" parent="." instance=ExtResource("1")]
enable_regeneration = true

[node name="EnemyCharacter#HealthLabel" type="Label3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2.3, 0)
text = "HP: 100"
script = ExtResource("2")

[node name="EnemyCharacter#DeathHandlerComponent" type="Node3D" parent="."]
script = ExtResource("3_lk9dp")

[node name="EnemyCharacter#BehaviorStateMachine" type="Node" parent="."]
script = ExtResource("5_yhoux")

[node name="IdleState" type="Node" parent="EnemyCharacter#BehaviorStateMachine"]
script = ExtResource("7_hzxm6")

[node name="CombatStateMachine" type="Node" parent="EnemyCharacter#BehaviorStateMachine"]
script = ExtResource("6_30fmc")

[node name="AttackState" type="Node" parent="EnemyCharacter#BehaviorStateMachine/CombatStateMachine"]
script = ExtResource("8_hau8f")

[node name="ChaseState" type="Node" parent="EnemyCharacter#BehaviorStateMachine/CombatStateMachine"]
script = ExtResource("9_xopsu")

[node name="FleeState" type="Node" parent="EnemyCharacter#BehaviorStateMachine/CombatStateMachine"]
script = ExtResource("10_fwdrj")
